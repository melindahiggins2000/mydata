<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.39">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Melinda Higgins">
<meta name="dcterms.date" content="2025-02-04">

<title>mydata dataset - Data Exploration and Cleanup</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="mydata_cleanup_files/libs/clipboard/clipboard.min.js"></script>
<script src="mydata_cleanup_files/libs/quarto-html/quarto.js"></script>
<script src="mydata_cleanup_files/libs/quarto-html/popper.min.js"></script>
<script src="mydata_cleanup_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="mydata_cleanup_files/libs/quarto-html/anchor.min.js"></script>
<link href="mydata_cleanup_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="mydata_cleanup_files/libs/quarto-html/quarto-syntax-highlighting-e26003cea8cd680ca0c55a263523d882.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="mydata_cleanup_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="mydata_cleanup_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="mydata_cleanup_files/libs/bootstrap/bootstrap-8a79a254b8e706d3c925cde0a310d4f0.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<link href="mydata_cleanup_files/libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">

<script src="mydata_cleanup_files/libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>

<link href="mydata_cleanup_files/libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">

<script src="mydata_cleanup_files/libs/datatables-binding-0.33/datatables.js"></script>

<script src="mydata_cleanup_files/libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>

<link href="mydata_cleanup_files/libs/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet">

<link href="mydata_cleanup_files/libs/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet">

<script src="mydata_cleanup_files/libs/dt-core-1.13.6/js/jquery.dataTables.min.js"></script>

<link href="mydata_cleanup_files/libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">

<script src="mydata_cleanup_files/libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>


  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#load-data" id="toc-load-data" class="nav-link active" data-scroll-target="#load-data">Load Data</a></li>
  <li><a href="#take-a-look-at-the-dataset" id="toc-take-a-look-at-the-dataset" class="nav-link" data-scroll-target="#take-a-look-at-the-dataset">Take a look at the dataset</a></li>
  <li><a href="#also-take-a-look-at-the-codebook" id="toc-also-take-a-look-at-the-codebook" class="nav-link" data-scroll-target="#also-take-a-look-at-the-codebook">Also take a look at the “codebook”</a></li>
  <li><a href="#open-discussion-on-what-you-see" id="toc-open-discussion-on-what-you-see" class="nav-link" data-scroll-target="#open-discussion-on-what-you-see">Open discussion on what you “see”</a></li>
  <li><a href="#list-of-issues" id="toc-list-of-issues" class="nav-link" data-scroll-target="#list-of-issues">List of issues</a></li>
  <li><a href="#code-to-find-issues" id="toc-code-to-find-issues" class="nav-link" data-scroll-target="#code-to-find-issues">Code to find issues</a>
  <ul class="collapse">
  <li><a href="#data-summaries---descriptive-statistics" id="toc-data-summaries---descriptive-statistics" class="nav-link" data-scroll-target="#data-summaries---descriptive-statistics">Data Summaries - descriptive statistics</a></li>
  <li><a href="#visualization---make-histograms---look-at-distributions" id="toc-visualization---make-histograms---look-at-distributions" class="nav-link" data-scroll-target="#visualization---make-histograms---look-at-distributions">Visualization - Make histograms - look at distributions</a></li>
  <li><a href="#data-wrangling" id="toc-data-wrangling" class="nav-link" data-scroll-target="#data-wrangling">Data Wrangling</a></li>
  <li><a href="#make-scatterplots---look-at-2-or-more-variables-at-once" id="toc-make-scatterplots---look-at-2-or-more-variables-at-once" class="nav-link" data-scroll-target="#make-scatterplots---look-at-2-or-more-variables-at-once">Make Scatterplots - look at 2 or more variables at once</a></li>
  </ul></li>
  <li><a href="#code-to-fix-issues" id="toc-code-to-fix-issues" class="nav-link" data-scroll-target="#code-to-fix-issues">Code to fix issues</a>
  <ul class="collapse">
  <li><a href="#set-values-of-9-and-99-to-missing---using-a-base-r-code-approach---but-dont-set-subject-id-9-to-missing" id="toc-set-values-of-9-and-99-to-missing---using-a-base-r-code-approach---but-dont-set-subject-id-9-to-missing" class="nav-link" data-scroll-target="#set-values-of-9-and-99-to-missing---using-a-base-r-code-approach---but-dont-set-subject-id-9-to-missing">1. Set values of 9 and 99 to missing - using a “base R” code approach - but don’t set Subject ID #9 to missing</a></li>
  <li><a href="#correct-typos-for-q1-q6" id="toc-correct-typos-for-q1-q6" class="nav-link" data-scroll-target="#correct-typos-for-q1-q6">2. Correct typos for q1-q6</a></li>
  <li><a href="#for-weightpre-convert-the-weights-70-from-kg-to-pounds-kg2.205-lbs" id="toc-for-weightpre-convert-the-weights-70-from-kg-to-pounds-kg2.205-lbs" class="nav-link" data-scroll-target="#for-weightpre-convert-the-weights-70-from-kg-to-pounds-kg2.205-lbs">3. For WeightPRE, convert the weights &lt; 70 from kg to pounds (kg*2.205 = lbs)</a></li>
  <li><a href="#for-id-28-change-2.6-feet-to-6.2-and-for-id-8-set-3.3-feet-to-na_real_-to-indicate-missing-for-real-numeric-data." id="toc-for-id-28-change-2.6-feet-to-6.2-and-for-id-8-set-3.3-feet-to-na_real_-to-indicate-missing-for-real-numeric-data." class="nav-link" data-scroll-target="#for-id-28-change-2.6-feet-to-6.2-and-for-id-8-set-3.3-feet-to-na_real_-to-indicate-missing-for-real-numeric-data.">4. For ID #28 change 2.6 feet to 6.2 and for ID #8 set 3.3 feet to <code>NA_real_</code> to indicate missing for real numeric data.</a></li>
  <li><a href="#for-the-2-typos-for-weightpost---make-these-changes" id="toc-for-the-2-typos-for-weightpost---make-these-changes" class="nav-link" data-scroll-target="#for-the-2-typos-for-weightpost---make-these-changes">5. For the 2 typos for WeightPOST - make these changes:</a></li>
  <li><a href="#shift-the-values-for-q2-and-q3-up-by-1-row-using-the-lead-function-from-dplyr.-lets-see-what-the-lead-and-lag-function-do." id="toc-shift-the-values-for-q2-and-q3-up-by-1-row-using-the-lead-function-from-dplyr.-lets-see-what-the-lead-and-lag-function-do." class="nav-link" data-scroll-target="#shift-the-values-for-q2-and-q3-up-by-1-row-using-the-lead-function-from-dplyr.-lets-see-what-the-lead-and-lag-function-do.">6. Shift the values for <code>q2</code> and <code>q3</code> up by 1 row using the <code>lead()</code> function from <code>dplyr</code>. Let’s see what the <code>lead()</code> and <code>lag()</code> function do.</a></li>
  <li><a href="#save-the-correct-values" id="toc-save-the-correct-values" class="nav-link" data-scroll-target="#save-the-correct-values">7. Save the correct values</a></li>
  <li><a href="#we-could-also-write-this-data-out-to-be-read-in-later---save-this-in-the-raw-binary-format-.rdata." id="toc-we-could-also-write-this-data-out-to-be-read-in-later---save-this-in-the-raw-binary-format-.rdata." class="nav-link" data-scroll-target="#we-could-also-write-this-data-out-to-be-read-in-later---save-this-in-the-raw-binary-format-.rdata.">8. We could also write this data out to be read in later - save this in the raw binary format <code>*.RData</code>.</a></li>
  <li><a href="#lets-create-bmi-for-pre-and-post" id="toc-lets-create-bmi-for-pre-and-post" class="nav-link" data-scroll-target="#lets-create-bmi-for-pre-and-post">9. Let’s create BMI for PRE and POST</a></li>
  </ul></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">mydata dataset - Data Exploration and Cleanup</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Melinda Higgins </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">February 4, 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="load-data" class="level2">
<h2 class="anchored" data-anchor-id="load-data">Load Data</h2>
<p>Read in the CSV file using the <code>readr</code> package</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>mydata <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"mydata.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="take-a-look-at-the-dataset" class="level2">
<h2 class="anchored" data-anchor-id="take-a-look-at-the-dataset">Take a look at the dataset</h2>
<p>Type <code>View(mydata)</code> at the prompt or run interactively from an R script or Rmarkdown document.</p>
<p>I will also be handing out a hard copy of these data so you can look at the data, the values and any patterns that emerge.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(mydata)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-e6dbbd2aa98b01b019ec" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-e6dbbd2aa98b01b019ec">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21"],[1,2,3,4,5,6,8,9,12,14,16,19,21,22,23,24,27,28,30,32,null],[45,50,35,44,32,48,50,51,46,35,36,40,99,52,24,35,51,43,36,44,null],[68,167,143,216,243,165,60,110,167,190,230,200,180,240,250,175,220,230,190,260,null],[145,166,135,201,223,145,132,108,158,200,210,195,185,220,240,174,221,98,180,109,null],[5.6,5.4,5.6,5.6,6,5.2,3.3,5.1,5.5,5.8,6.2,6.1,5.9,6.5,6.4,5.8,6.3,2.6,5.7,6.4,null],[9,2,2,2,2,2,2,3,2,1,1,1,3,2,2,2,2,2,1,3,null],["m","f",null,"m","m","f","m","f","F","Male","m","f","f","m","M","F","m","m","female","male",null],[1,2,null,1,1,2,1,2,2,1,1,2,2,1,1,2,1,1,2,1,null],[4,3,3,4,5,2,3,1,1,4,1,1,2,2,5,5,4,11,5,1,null],[null,4,4,2,3,5,null,4,1,44,1,4,5,2,5,9,1,4,1,2,4],[null,1,2,2,5,5,4,1,5,1,3,4,5,2,3,1,4,9,1,1,4],[4,40,3,1,2,1,3,3,5,1,null,4,2,4,2,4,2,null,null,null,null],[4,3,5,1,4,4,9,1,1,4,5,1,5,99,5,2,3,null,null,null,null],[5,2,2,9,1,5,2,4,2,5,2,5,4,5,3,4,3,null,null,null,null]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>SubjectID<\/th>\n      <th>Age<\/th>\n      <th>WeightPRE<\/th>\n      <th>WeightPOST<\/th>\n      <th>Height<\/th>\n      <th>SES<\/th>\n      <th>GenderSTR<\/th>\n      <th>GenderCoded<\/th>\n      <th>q1<\/th>\n      <th>q2<\/th>\n      <th>q3<\/th>\n      <th>q4<\/th>\n      <th>q5<\/th>\n      <th>q6<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pagelength":21,"autowidth":true,"columnDefs":[{"className":"dt-right","targets":[1,2,3,4,5,6,8,9,10,11,12,13,14]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"SubjectID","targets":1},{"name":"Age","targets":2},{"name":"WeightPRE","targets":3},{"name":"WeightPOST","targets":4},{"name":"Height","targets":5},{"name":"SES","targets":6},{"name":"GenderSTR","targets":7},{"name":"GenderCoded","targets":8},{"name":"q1","targets":9},{"name":"q2","targets":10},{"name":"q3","targets":11},{"name":"q4","targets":12},{"name":"q5","targets":13},{"name":"q6","targets":14}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="also-take-a-look-at-the-codebook" class="level2">
<h2 class="anchored" data-anchor-id="also-take-a-look-at-the-codebook">Also take a look at the “codebook”</h2>
<p>Feel free to click on links below or right click and “SaveAs” to save the file on your computer.</p>
<ul>
<li><a href="Mydata_Codebook.docx">Codebook in DOC format</a></li>
<li><a href="Mydata_Codebook.pdf">Codebook in PDF format</a></li>
</ul>
</section>
<section id="open-discussion-on-what-you-see" class="level2">
<h2 class="anchored" data-anchor-id="open-discussion-on-what-you-see">Open discussion on what you “see”</h2>
<p>There are 11-12 problems with this little dataset. Which ones do you see?</p>
<ol type="1">
<li><p>How might we use code to FIND (discover) these problems?</p></li>
<li><p>How might we use code to FIX (correct) these problems?</p></li>
</ol>
</section>
<section id="list-of-issues" class="level2">
<h2 class="anchored" data-anchor-id="list-of-issues">List of issues</h2>
<ol type="1">
<li>Is Age 99 correct or not? (discussion on how to code missing, look at histogram of age distributions – does someone aged 99 seem reasonable)?</li>
<li>There are 2 people with a Weight (in pounds) &lt; 100. Are these correct? These are probably weights in kg instead of in pounds. We can spot these via histograms, but since we have weights pre and post we can compare these to make some reasonable guesses.</li>
<li>There are also 2 weights post that are very different than their pre weights – this we can see in a 2D scatterplot</li>
<li>There are 2 heights (in decimal feet) &lt; 4 feet tall. One is probably a simple typo 2.6 feet should most likely be 6.2 feet. But 3.3 could be correct or incorrect. Could this possibly be a paraplegic? [I did encounter this in one study a while ago…] Should we keep or remove this data from the rest of the analyses?</li>
<li>There are values of 9 for SES, and in the q1-q6 items that should be changed to missing</li>
<li>GenderSTR was captured as “free text” versus GenderCoded where 1=Male, 2=Female – we can discuss the blank/missing values and how these differ for text versus numeric columns</li>
<li>There is an 11 for q1 – this is probably a typo for 1</li>
<li>There is a 44 for q2 – probably a typo for 4</li>
<li>There is a 40 for q4 – probably a typo for 4</li>
<li>There is a 99 for q5 – also set to missing</li>
<li>For subjects 28, 30, 32 items q4,q5,q6 are all missing in a block – why? [I had this happen in 1 study where people were not flipping the page over to finish the 2nd page of the survey.]</li>
<li>There is also this weird blank row with no subject ID where it looks like q2 and q3 are shifted down by 1 row. This leads to all of the variables having missing data when we shouldn’t have much…</li>
</ol>
</section>
<section id="code-to-find-issues" class="level2">
<h2 class="anchored" data-anchor-id="code-to-find-issues">Code to find issues</h2>
<section id="data-summaries---descriptive-statistics" class="level3">
<h3 class="anchored" data-anchor-id="data-summaries---descriptive-statistics">Data Summaries - descriptive statistics</h3>
<p>Use summary statistics to:</p>
<ul>
<li>look at min and max
<ul>
<li>are these in the correct range?</li>
</ul></li>
<li>look at mean and median
<ul>
<li>are they similar?</li>
<li>what does it indicate if the mean and median are not similar</li>
</ul></li>
<li>are there any missing values (NA’s)?
<ul>
<li>should there be missing data?</li>
<li>how is the missing data coded or indicated in the dataset?</li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mydata)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   SubjectID          Age          WeightPRE       WeightPOST   
 Min.   : 1.00   Min.   :24.00   Min.   : 60.0   Min.   : 98.0  
 1st Qu.: 5.75   1st Qu.:35.75   1st Qu.:166.5   1st Qu.:142.5  
 Median :15.00   Median :44.00   Median :190.0   Median :177.0  
 Mean   :15.30   Mean   :44.80   Mean   :185.2   Mean   :172.2  
 3rd Qu.:23.25   3rd Qu.:50.00   3rd Qu.:230.0   3rd Qu.:203.2  
 Max.   :32.00   Max.   :99.00   Max.   :260.0   Max.   :240.0  
 NA's   :1       NA's   :1       NA's   :1       NA's   :1      
     Height           SES       GenderSTR          GenderCoded   
 Min.   :2.600   Min.   :1.0   Length:21          Min.   :1.000  
 1st Qu.:5.475   1st Qu.:2.0   Class :character   1st Qu.:1.000  
 Median :5.750   Median :2.0   Mode  :character   Median :1.000  
 Mean   :5.550   Mean   :2.3                      Mean   :1.421  
 3rd Qu.:6.125   3rd Qu.:2.0                      3rd Qu.:2.000  
 Max.   :6.500   Max.   :9.0                      Max.   :2.000  
 NA's   :1       NA's   :1                        NA's   :2      
       q1              q2               q3             q4        
 Min.   : 1.00   Min.   : 1.000   Min.   :1.00   Min.   : 1.000  
 1st Qu.: 1.75   1st Qu.: 2.000   1st Qu.:1.00   1st Qu.: 2.000  
 Median : 3.00   Median : 4.000   Median :3.00   Median : 3.000  
 Mean   : 3.35   Mean   : 5.526   Mean   :3.15   Mean   : 5.062  
 3rd Qu.: 4.25   3rd Qu.: 4.500   3rd Qu.:4.25   3rd Qu.: 4.000  
 Max.   :11.00   Max.   :44.000   Max.   :9.00   Max.   :40.000  
 NA's   :1       NA's   :2        NA's   :1      NA's   :5       
       q5               q6       
 Min.   : 1.000   Min.   :1.000  
 1st Qu.: 2.000   1st Qu.:2.000  
 Median : 4.000   Median :4.000  
 Mean   : 9.176   Mean   :3.706  
 3rd Qu.: 5.000   3rd Qu.:5.000  
 Max.   :99.000   Max.   :9.000  
 NA's   :4        NA's   :4      </code></pre>
</div>
</div>
<p>Load the <code>dplyr</code> package to use <code>%&gt;%</code> and <code>select()</code> and the <code>psych</code> package to use <code>psych::describe()</code> functions.</p>
<p>In the code below, I am selecting only the numeric columns using the <code>where(is.numeric)</code> code inside the <code>select()</code>.</p>
<p>I also added another <code>select()</code> to remove (or drop) the <code>SubjectID</code> column which is numeric, but we do not need to compute the statistics for the ID numbers. To drop this column I put the exclamation point <code>!</code> in front which means to NOT select this column. You could also write it putting a minus <code>-</code> sign in front instead of the <code>!</code> by using <code>select(-SubjectID)</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psych)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>mydata <span class="sc">%&gt;%</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">where</span>(is.numeric)) <span class="sc">%&gt;%</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">!</span>SubjectID) <span class="sc">%&gt;%</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  psych<span class="sc">::</span><span class="fu">describe</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 10%">
<col style="width: 4%">
<col style="width: 2%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 5%">
<col style="width: 9%">
<col style="width: 7%">
<col style="width: 4%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">vars</th>
<th style="text-align: right;">n</th>
<th style="text-align: right;">mean</th>
<th style="text-align: right;">sd</th>
<th style="text-align: right;">median</th>
<th style="text-align: right;">trimmed</th>
<th style="text-align: right;">mad</th>
<th style="text-align: right;">min</th>
<th style="text-align: right;">max</th>
<th style="text-align: right;">range</th>
<th style="text-align: right;">skew</th>
<th style="text-align: right;">kurtosis</th>
<th style="text-align: right;">se</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Age</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">20</td>
<td style="text-align: right;">44.800000</td>
<td style="text-align: right;">14.8664228</td>
<td style="text-align: right;">44.00</td>
<td style="text-align: right;">43.062500</td>
<td style="text-align: right;">10.37820</td>
<td style="text-align: right;">24.0</td>
<td style="text-align: right;">99.0</td>
<td style="text-align: right;">75.0</td>
<td style="text-align: right;">2.2063564</td>
<td style="text-align: right;">6.1012897</td>
<td style="text-align: right;">3.3242332</td>
</tr>
<tr class="even">
<td style="text-align: left;">WeightPRE</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">20</td>
<td style="text-align: right;">185.200000</td>
<td style="text-align: right;">56.4871667</td>
<td style="text-align: right;">190.00</td>
<td style="text-align: right;">191.625000</td>
<td style="text-align: right;">51.89100</td>
<td style="text-align: right;">60.0</td>
<td style="text-align: right;">260.0</td>
<td style="text-align: right;">200.0</td>
<td style="text-align: right;">-0.7743422</td>
<td style="text-align: right;">-0.3013193</td>
<td style="text-align: right;">12.6309145</td>
</tr>
<tr class="odd">
<td style="text-align: left;">WeightPOST</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">20</td>
<td style="text-align: right;">172.250000</td>
<td style="text-align: right;">42.2796143</td>
<td style="text-align: right;">177.00</td>
<td style="text-align: right;">173.500000</td>
<td style="text-align: right;">48.18450</td>
<td style="text-align: right;">98.0</td>
<td style="text-align: right;">240.0</td>
<td style="text-align: right;">142.0</td>
<td style="text-align: right;">-0.2040592</td>
<td style="text-align: right;">-1.2586077</td>
<td style="text-align: right;">9.4540092</td>
</tr>
<tr class="even">
<td style="text-align: left;">Height</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">20</td>
<td style="text-align: right;">5.550000</td>
<td style="text-align: right;">0.9795273</td>
<td style="text-align: right;">5.75</td>
<td style="text-align: right;">5.762500</td>
<td style="text-align: right;">0.51891</td>
<td style="text-align: right;">2.6</td>
<td style="text-align: right;">6.5</td>
<td style="text-align: right;">3.9</td>
<td style="text-align: right;">-1.8132522</td>
<td style="text-align: right;">2.6446547</td>
<td style="text-align: right;">0.2190290</td>
</tr>
<tr class="odd">
<td style="text-align: left;">SES</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">20</td>
<td style="text-align: right;">2.300000</td>
<td style="text-align: right;">1.6889735</td>
<td style="text-align: right;">2.00</td>
<td style="text-align: right;">2.000000</td>
<td style="text-align: right;">0.00000</td>
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">9.0</td>
<td style="text-align: right;">8.0</td>
<td style="text-align: right;">3.0373478</td>
<td style="text-align: right;">9.4568496</td>
<td style="text-align: right;">0.3776660</td>
</tr>
<tr class="even">
<td style="text-align: left;">GenderCoded</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">19</td>
<td style="text-align: right;">1.421053</td>
<td style="text-align: right;">0.5072573</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">1.411765</td>
<td style="text-align: right;">0.00000</td>
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">2.0</td>
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">0.2948888</td>
<td style="text-align: right;">-2.0107026</td>
<td style="text-align: right;">0.1163728</td>
</tr>
<tr class="odd">
<td style="text-align: left;">q1</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">20</td>
<td style="text-align: right;">3.350000</td>
<td style="text-align: right;">2.3457689</td>
<td style="text-align: right;">3.00</td>
<td style="text-align: right;">3.062500</td>
<td style="text-align: right;">2.22390</td>
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">11.0</td>
<td style="text-align: right;">10.0</td>
<td style="text-align: right;">1.5276108</td>
<td style="text-align: right;">2.9740250</td>
<td style="text-align: right;">0.5245299</td>
</tr>
<tr class="even">
<td style="text-align: left;">q2</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">19</td>
<td style="text-align: right;">5.526316</td>
<td style="text-align: right;">9.5240539</td>
<td style="text-align: right;">4.00</td>
<td style="text-align: right;">3.529412</td>
<td style="text-align: right;">1.48260</td>
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">44.0</td>
<td style="text-align: right;">43.0</td>
<td style="text-align: right;">3.4391747</td>
<td style="text-align: right;">11.0307874</td>
<td style="text-align: right;">2.1849678</td>
</tr>
<tr class="odd">
<td style="text-align: left;">q3</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">20</td>
<td style="text-align: right;">3.150000</td>
<td style="text-align: right;">2.0844032</td>
<td style="text-align: right;">3.00</td>
<td style="text-align: right;">2.937500</td>
<td style="text-align: right;">2.96520</td>
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">9.0</td>
<td style="text-align: right;">8.0</td>
<td style="text-align: right;">0.9042716</td>
<td style="text-align: right;">0.5852980</td>
<td style="text-align: right;">0.4660867</td>
</tr>
<tr class="even">
<td style="text-align: left;">q4</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">16</td>
<td style="text-align: right;">5.062500</td>
<td style="text-align: right;">9.3983598</td>
<td style="text-align: right;">3.00</td>
<td style="text-align: right;">2.857143</td>
<td style="text-align: right;">1.48260</td>
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">40.0</td>
<td style="text-align: right;">39.0</td>
<td style="text-align: right;">3.1845605</td>
<td style="text-align: right;">8.9452972</td>
<td style="text-align: right;">2.3495899</td>
</tr>
<tr class="odd">
<td style="text-align: left;">q5</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">17</td>
<td style="text-align: right;">9.176471</td>
<td style="text-align: right;">23.2385329</td>
<td style="text-align: right;">4.00</td>
<td style="text-align: right;">3.733333</td>
<td style="text-align: right;">1.48260</td>
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">99.0</td>
<td style="text-align: right;">98.0</td>
<td style="text-align: right;">3.3788412</td>
<td style="text-align: right;">10.1359154</td>
<td style="text-align: right;">5.6361721</td>
</tr>
<tr class="even">
<td style="text-align: left;">q6</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">17</td>
<td style="text-align: right;">3.705882</td>
<td style="text-align: right;">1.9288826</td>
<td style="text-align: right;">4.00</td>
<td style="text-align: right;">3.533333</td>
<td style="text-align: right;">1.48260</td>
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">9.0</td>
<td style="text-align: right;">8.0</td>
<td style="text-align: right;">0.9340719</td>
<td style="text-align: right;">0.8076514</td>
<td style="text-align: right;">0.4678228</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>So as you can see in the tables above:</p>
<ul>
<li>every variable has missing data - should they?</li>
<li>notice the max values of 9 and 99</li>
<li>notice that for the q1-q6 items the values should range between 1-5, but there are some values of 11, 40, and 44</li>
<li>notice that for Weight PRE there are values &lt; 100? does this seem correct?</li>
<li>notice that q4, q5, q6 have the most missing data (4 NA’s)</li>
</ul>
</section>
<section id="visualization---make-histograms---look-at-distributions" class="level3">
<h3 class="anchored" data-anchor-id="visualization---make-histograms---look-at-distributions">Visualization - Make histograms - look at distributions</h3>
<p>Let’s use the <code>ggplot2</code> package to make some histograms of</p>
<ul>
<li><code>Age</code></li>
<li><code>WeightPRE</code> and</li>
<li><code>Height</code></li>
</ul>
<p>Notice the possible outlier for age &gt; 90.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mydata,</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> Age)) <span class="sc">+</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">fill =</span> <span class="st">"lightblue"</span>,</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Histogram of Age"</span>,</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Look at Distribution and Outliers"</span>,</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">"mydata hypothetical dataset"</span>) <span class="sc">+</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Age in Years"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mydata_cleanup_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Notice the odds values for weights &lt; 100 lbs (pounds).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mydata,</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> WeightPRE)) <span class="sc">+</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">fill =</span> <span class="st">"lightgreen"</span>,</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Histogram of Weight before program"</span>,</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Look at Distribution and Outliers"</span>,</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">"mydata hypothetical dataset"</span>) <span class="sc">+</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Weight (in pounds)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mydata_cleanup_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Notice the really low heights &lt; 4 feet?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mydata,</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> Height)) <span class="sc">+</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">fill =</span> <span class="st">"yellow"</span>,</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Histogram of Heights"</span>,</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Look at Distribution and Outliers"</span>,</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">"mydata hypothetical dataset"</span>) <span class="sc">+</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Height (in decimal feet)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mydata_cleanup_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="data-wrangling" class="level3">
<h3 class="anchored" data-anchor-id="data-wrangling">Data Wrangling</h3>
<p>Let’s use the <code>dplyr</code> package and the <code>arrange()</code> function to find the IDs with problematic data.</p>
<p>Find the IDs with the oldest ages - use <code>desc()</code> to sort descending. ID #21 is age 99 and then next oldest person is ID # 22 who is age 52.</p>
<p>Is age 99 a real age or missing? What do you think given the rest of the ages in the dataset?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>mydata <span class="sc">%&gt;%</span>                    <span class="co"># start with mydata</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(Age)) <span class="sc">%&gt;%</span>      <span class="co"># sort descending by Age</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(SubjectID, Age) <span class="sc">%&gt;%</span>  <span class="co"># select IDs and Age</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>()                      <span class="co"># show the top 6 rows</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 2
  SubjectID   Age
      &lt;dbl&gt; &lt;dbl&gt;
1        21    99
2        22    52
3         9    51
4        27    51
5         2    50
6         8    50</code></pre>
</div>
</div>
<p>Get the IDs for the people with the shortest heights. ID #28 is only 2.6 feet tall and ID #8 is 3.3 feet tall. Do these seem reasonable. What do you think happened?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>mydata <span class="sc">%&gt;%</span>                      <span class="co"># start with mydata</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(Height) <span class="sc">%&gt;%</span>           <span class="co"># sort ascending by Height</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(SubjectID, Height) <span class="sc">%&gt;%</span> <span class="co"># select IDs and Height</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>()                        <span class="co"># show the bottom 6 rows</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 2
  SubjectID Height
      &lt;dbl&gt;  &lt;dbl&gt;
1        28    2.6
2         8    3.3
3         9    5.1
4         6    5.2
5         2    5.4
6        12    5.5</code></pre>
</div>
</div>
<p>Look at the small weights at PRE. IDs #8 and #1 have weights of only 60 and 68 pounds? Could this be the wrong units - maybe these are weights in kilograms (kg*2.205 = lbs)?</p>
<ul>
<li>60 kilograms = 132.3 pounds</li>
<li>68 kilograms = 149.9 pounds</li>
</ul>
<p>These weights in pounds seem more reasonable.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>mydata <span class="sc">%&gt;%</span> </span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(WeightPRE) <span class="sc">%&gt;%</span>           </span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(SubjectID, WeightPRE) <span class="sc">%&gt;%</span> </span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>()  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 2
  SubjectID WeightPRE
      &lt;dbl&gt;     &lt;dbl&gt;
1         8        60
2         1        68
3         9       110
4         3       143
5         6       165
6         2       167</code></pre>
</div>
</div>
<p>Let’s also see if we can spot the IDs for the weights at PRE and at POST that are very different. Let’s compute the difference scores and look at the sorted differences by absolute value (using the <code>abs()</code> function).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>mydata <span class="ot">&lt;-</span> mydata <span class="sc">%&gt;%</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">diffWeight =</span> WeightPRE <span class="sc">-</span> WeightPOST,</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">abs_diffWeight =</span> <span class="fu">abs</span>(diffWeight))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Sort by the largest differences (+ or -). Show the top 10 rows.</p>
<p>Notice ID 32 has a PRE weight of 260 lbs but a post weight of 109 lbs - maybe the 109 should be 209?</p>
<p>ID 28 also has an unusually large difference, 230 lbs at PRE but only 98 lbs at POST - maybe this should be 198 lbs?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>mydata <span class="sc">%&gt;%</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(abs_diffWeight)) <span class="sc">%&gt;%</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(SubjectID, </span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>         abs_diffWeight, </span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>         WeightPRE, </span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>         WeightPOST) <span class="sc">%&gt;%</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="at">n=</span><span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 4
   SubjectID abs_diffWeight WeightPRE WeightPOST
       &lt;dbl&gt;          &lt;dbl&gt;     &lt;dbl&gt;      &lt;dbl&gt;
 1        32            151       260        109
 2        28            132       230         98
 3         1             77        68        145
 4         8             72        60        132
 5         5             20       243        223
 6         6             20       165        145
 7        16             20       230        210
 8        22             20       240        220
 9         4             15       216        201
10        14             10       190        200</code></pre>
</div>
</div>
</section>
<section id="make-scatterplots---look-at-2-or-more-variables-at-once" class="level3">
<h3 class="anchored" data-anchor-id="make-scatterplots---look-at-2-or-more-variables-at-once">Make Scatterplots - look at 2 or more variables at once</h3>
<p>Plot of Weight PRE and Weight POST along with Gender.</p>
<p>Before the plot, let’s create a new “factor-type” variable for Gender, so we can use gender as a discrete categorical variable to assign colors.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>mydata <span class="ot">&lt;-</span> mydata <span class="sc">%&gt;%</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">GenderCoded.f =</span> <span class="fu">factor</span>(</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>      GenderCoded,</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>),</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Male"</span>,</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"Female"</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Notice the 2 really small Weight PRE values and the 2 high Weight PRE values that also have really low Weight POST values. Also notice that all 4 of these outliers are “males”.</p>
<p>Add a 45 degree diagonal line Y = X to help see if people weighed more or less at POST compared to PRE. Most of the points have PRE values &gt; POST indicating most people lost weight. But we need to figure out/correct these outliers first.</p>
<p>Use <code>scale_color_manual()</code> to add custom colors and then use <code>color = ""</code> to add a custom label for the color legend for the gender categories.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mydata,</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> WeightPRE, </span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> WeightPOST,</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> GenderCoded.f)) <span class="sc">+</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intecept =</span> <span class="dv">0</span>,</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>              <span class="at">slope =</span> <span class="dv">1</span>,</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"blue"</span>, </span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"magenta"</span>),</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>                     <span class="at">na.value =</span> <span class="st">"grey30"</span>) <span class="sc">+</span></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Weight PRE (in pounds)"</span>) <span class="sc">+</span></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Weight POST (in pounds)"</span>) <span class="sc">+</span> </span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Compare Weight PRE and POST"</span>,</span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Add Y=X line"</span>,</span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> <span class="st">"mydata hypothetical dataset"</span>,</span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Gender"</span></span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mydata_cleanup_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Another option since we don’t have too much data - we can add text labels for each data point using the Subject IDs.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mydata,</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> WeightPRE, </span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> WeightPOST,</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> GenderCoded.f)) <span class="sc">+</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> SubjectID)) <span class="sc">+</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intecept =</span> <span class="dv">0</span>,</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>              <span class="at">slope =</span> <span class="dv">1</span>,</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"blue"</span>, </span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"magenta"</span>),</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>                     <span class="at">na.value =</span> <span class="st">"grey30"</span>) <span class="sc">+</span></span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Weight PRE (in pounds)"</span>) <span class="sc">+</span></span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Weight POST (in pounds)"</span>) <span class="sc">+</span> </span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Compare Weight PRE and POST"</span>,</span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Add Y=X line"</span>,</span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> <span class="st">"mydata hypothetical dataset"</span>,</span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Gender"</span></span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mydata_cleanup_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="code-to-fix-issues" class="level2">
<h2 class="anchored" data-anchor-id="code-to-fix-issues">Code to fix issues</h2>
<p>As we make corrections and updates, let create a new dataset called <code>mydata_corrected</code>.</p>
<p>Let’s make the following edits:</p>
<section id="set-values-of-9-and-99-to-missing---using-a-base-r-code-approach---but-dont-set-subject-id-9-to-missing" class="level3">
<h3 class="anchored" data-anchor-id="set-values-of-9-and-99-to-missing---using-a-base-r-code-approach---but-dont-set-subject-id-9-to-missing">1. Set values of 9 and 99 to missing - using a “base R” code approach - but don’t set Subject ID #9 to missing</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># make copy of original data</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="co"># remove SubjectID column first</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>mydata_corrected <span class="ot">&lt;-</span> mydata <span class="sc">%&gt;%</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>SubjectID)</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a><span class="co"># set all values of 99 to NA missing</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>mydata_corrected[mydata_corrected <span class="sc">==</span> <span class="dv">99</span>] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a><span class="co"># set all values of 9 to NA missing</span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>mydata_corrected[mydata_corrected <span class="sc">==</span> <span class="dv">9</span>] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a><span class="co"># add SubjectID back to dataset</span></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>mydata_corrected<span class="sc">$</span>SubjectID <span class="ot">&lt;-</span> mydata<span class="sc">$</span>SubjectID</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Take a quick look at histogram of age again</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mydata_corrected,</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> Age)) <span class="sc">+</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">fill =</span> <span class="st">"lightblue"</span>,</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Histogram of Age - Corrected Dataset"</span>,</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Look at Distribution and Outliers"</span>,</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">"mydata hypothetical dataset"</span>) <span class="sc">+</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Age in Years"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mydata_cleanup_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Let’s also make these edits using <code>mutate()</code> function from <code>dplyr</code>.</p>
</section>
<section id="correct-typos-for-q1-q6" class="level3">
<h3 class="anchored" data-anchor-id="correct-typos-for-q1-q6">2. Correct typos for q1-q6</h3>
<pre><code>- set value of 11 to 1
- set value of 40 and 44 to 4</code></pre>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create new corrected variable</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>mydata_corrected <span class="ot">&lt;-</span> mydata_corrected <span class="sc">%&gt;%</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">q1_fix =</span> <span class="fu">case_when</span>(</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>    (q1 <span class="sc">==</span> <span class="dv">11</span>) <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>    (q1 <span class="sc">==</span> <span class="dv">40</span>) <span class="sc">~</span> <span class="dv">4</span>,</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>    (q1 <span class="sc">==</span> <span class="dv">44</span>) <span class="sc">~</span> <span class="dv">4</span>,</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">.default =</span> q1</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>  ))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can speed this up a bit by using the <code>across()</code> function as well, see <a href="https://www.r-bloggers.com/2023/10/a-couple-of-case_when-tricks/#google_vignette">https://www.r-bloggers.com/2023/10/a-couple-of-case_when-tricks/#google_vignette</a>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># this corrects all q variables at once</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="co"># but overwrites the original q items</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>mydata_corrected <span class="ot">&lt;-</span> mydata_corrected <span class="sc">%&gt;%</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">across</span>(<span class="fu">starts_with</span>(<span class="st">"q"</span>),</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>           <span class="sc">~</span> <span class="fu">case_when</span>(</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>             (. <span class="sc">==</span> <span class="dv">11</span>) <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>             (. <span class="sc">==</span> <span class="dv">40</span>) <span class="sc">~</span> <span class="dv">4</span>,</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>             (. <span class="sc">==</span> <span class="dv">44</span>) <span class="sc">~</span> <span class="dv">4</span>,</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">.default =</span> .)</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>           )</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="for-weightpre-convert-the-weights-70-from-kg-to-pounds-kg2.205-lbs" class="level3">
<h3 class="anchored" data-anchor-id="for-weightpre-convert-the-weights-70-from-kg-to-pounds-kg2.205-lbs">3. For WeightPRE, convert the weights &lt; 70 from kg to pounds (kg*2.205 = lbs)</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>mydata_corrected <span class="ot">&lt;-</span> mydata_corrected <span class="sc">%&gt;%</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">WeightPRE_fix =</span> <span class="fu">case_when</span>(</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>      (WeightPRE <span class="sc">&lt;</span> <span class="dv">70</span>) <span class="sc">~</span> WeightPRE<span class="sc">*</span><span class="fl">2.205</span>,</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">.default =</span> WeightPRE</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="for-id-28-change-2.6-feet-to-6.2-and-for-id-8-set-3.3-feet-to-na_real_-to-indicate-missing-for-real-numeric-data." class="level3">
<h3 class="anchored" data-anchor-id="for-id-28-change-2.6-feet-to-6.2-and-for-id-8-set-3.3-feet-to-na_real_-to-indicate-missing-for-real-numeric-data.">4. For ID #28 change 2.6 feet to 6.2 and for ID #8 set 3.3 feet to <code>NA_real_</code> to indicate missing for real numeric data.</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>mydata_corrected <span class="ot">&lt;-</span> mydata_corrected <span class="sc">%&gt;%</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">Height_fix =</span> <span class="fu">case_when</span>(</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>      (SubjectID <span class="sc">==</span> <span class="dv">28</span>) <span class="sc">~</span> <span class="fl">6.2</span>,</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>      (SubjectID <span class="sc">==</span> <span class="dv">8</span>) <span class="sc">~</span> <span class="cn">NA_real_</span>,</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">.default =</span> Height</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="for-the-2-typos-for-weightpost---make-these-changes" class="level3">
<h3 class="anchored" data-anchor-id="for-the-2-typos-for-weightpost---make-these-changes">5. For the 2 typos for WeightPOST - make these changes:</h3>
<ul>
<li>Change ID 32’s POST weight from 109 lbs to 209 lbs</li>
<li>Change ID 28’s POST weight from 98 lbs to 198 lbs</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>mydata_corrected <span class="ot">&lt;-</span> mydata_corrected <span class="sc">%&gt;%</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">WeightPOST_fix =</span> <span class="fu">case_when</span>(</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>      (SubjectID <span class="sc">==</span> <span class="dv">32</span>) <span class="sc">~</span> <span class="dv">209</span>,</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>      (SubjectID <span class="sc">==</span> <span class="dv">28</span>) <span class="sc">~</span> <span class="dv">198</span>,</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">.default =</span> WeightPOST</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="shift-the-values-for-q2-and-q3-up-by-1-row-using-the-lead-function-from-dplyr.-lets-see-what-the-lead-and-lag-function-do." class="level3">
<h3 class="anchored" data-anchor-id="shift-the-values-for-q2-and-q3-up-by-1-row-using-the-lead-function-from-dplyr.-lets-see-what-the-lead-and-lag-function-do.">6. Shift the values for <code>q2</code> and <code>q3</code> up by 1 row using the <code>lead()</code> function from <code>dplyr</code>. Let’s see what the <code>lead()</code> and <code>lag()</code> function do.</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># see the order of values for q2</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>mydata<span class="sc">$</span>q2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] NA  4  4  2  3  5 NA  4  1 44  1  4  5  2  5  9  1  4  1  2  4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># see shift using lag()</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">lag</span>(mydata<span class="sc">$</span>q2, <span class="at">n=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] NA NA  4  4  2  3  5 NA  4  1 44  1  4  5  2  5  9  1  4  1  2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># see shift using lead()</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">lead</span>(mydata<span class="sc">$</span>q2, <span class="at">n=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1]  4  4  2  3  5 NA  4  1 44  1  4  5  2  5  9  1  4  1  2  4 NA</code></pre>
</div>
</div>
<p>Correct <code>q2</code> and <code>q3</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>mydata_corrected <span class="ot">&lt;-</span> mydata_corrected <span class="sc">%&gt;%</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">q2_fix =</span> <span class="fu">lead</span>(q2, <span class="at">n=</span><span class="dv">1</span>),</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">q3_fix =</span> <span class="fu">lead</span>(q3, <span class="at">n=</span><span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="save-the-correct-values" class="level3">
<h3 class="anchored" data-anchor-id="save-the-correct-values">7. Save the correct values</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>mydata_final <span class="ot">&lt;-</span> mydata_corrected <span class="sc">%&gt;%</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(SubjectID)) <span class="sc">%&gt;%</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(SubjectID,</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>         Age,</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>         SES,</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>         Height_fix,</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>         WeightPRE_fix,</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>         WeightPOST_fix,</span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>         GenderCoded.f,</span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>         q1_fix,</span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>         q2_fix,</span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>         q3_fix,</span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a>         q4,</span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a>         q5,</span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a>         q6)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="we-could-also-write-this-data-out-to-be-read-in-later---save-this-in-the-raw-binary-format-.rdata." class="level3">
<h3 class="anchored" data-anchor-id="we-could-also-write-this-data-out-to-be-read-in-later---save-this-in-the-raw-binary-format-.rdata.">8. We could also write this data out to be read in later - save this in the raw binary format <code>*.RData</code>.</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(mydata_final,</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">file =</span> <span class="st">"mydata_final.RData"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can clean up our Global Environment and then read back in this cleaned and corrected dataset.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ls</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>character(0)</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="at">file =</span> <span class="st">"mydata_final.RData"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="lets-create-bmi-for-pre-and-post" class="level3">
<h3 class="anchored" data-anchor-id="lets-create-bmi-for-pre-and-post">9. Let’s create BMI for PRE and POST</h3>
<p>So, let’s compute BMI (body mass index) as follows from Height (in inches) and Weight (in pounds):</p>
<p><span class="math display">\[BMI = \left(\frac{weight_{(lbs)}}{(height_{(inches)})^2}\right) * 703\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute BMI for the PRE Weight</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>mydata_final <span class="ot">&lt;-</span> mydata_final <span class="sc">%&gt;%</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">bmiPRE =</span> (WeightPRE_fix <span class="sc">*</span> <span class="dv">703</span>) <span class="sc">/</span> (Height_fix <span class="sc">*</span> <span class="dv">12</span>)<span class="sc">^</span><span class="dv">2</span>,</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">bmiPOST =</span> (WeightPOST_fix <span class="sc">*</span> <span class="dv">703</span>) <span class="sc">/</span> (Height_fix <span class="sc">*</span> <span class="dv">12</span>)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a><span class="co"># look at histograms of BMI</span></span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mydata_final,</span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> bmiPRE)) <span class="sc">+</span></span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">fill =</span> <span class="st">"lightgreen"</span>,</span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> <span class="st">"black"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mydata_cleanup_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>